{# *********************************************
   * POWER Theme Section Media Content Split V1.1               
   - Animation on Scroll               
   ********************************************* #}

{%- macro get_aos(aos_el) %}
  {%- if theme.animation.aos.is_aos && module.animation.is_aos && aos_el.animation_type != 'none' %}
    {%- if aos_el.animation_type == 'default' %}
      data-aos="{{ theme.animation.aos.animation_type }}"
    {% else %}
      data-aos="{{ aos_el.animation_type }}"
    {% endif -%} 
    {%- if aos_el.delay %}
      data-aos-delay="{{ aos_el.delay }}"
    {% else %}
      data-aos-delay="{{ theme.animation.aos.delay }}"
    {% endif -%}
  {% endif -%}  
{% endmacro -%}

{% if module.style.background == 'color' && module.style.background_color %}
  {% set bgColor = module.style.background_color.color|convert_rgb %}
  {% set bgOpacity = module.style.background_color.opacity|int %}
  {% set bgOpacity = bgOpacity / 100 %}

{% elif module.style.background == 'img_vid' %}
  {% if module.style.background_image || module.style.background_video || module.style.youtube_link %}
    {% set bgImg = module.style.background_image %}
    {% if module.style.background_video %}
      {% set bgVid = module.style.background_video %}
    {% elif  module.style.youtube_link %}
      {% set isYtVid = true %}
      {% set bgVid = module.style.youtube_link %}
    {% endif %}
    {% set bgImgPos  = module.style.background_position %}
    {% set bgVidPos  = 'pwr-video-background--pos-' + module.style.background_position %}

    {% if module.style.background_image_overlay == 'color' %}
      {% set bgOverlayColor = module.style.overlay_color.color|convert_rgb %}
      {% set bgOverlayOpacity = module.style.overlay_color.opacity|int %}
      {% set bgOverlayOpacity = bgOverlayOpacity / 100 %}

    {% elif module.style.background_image_overlay == 'gradient' %}
      {% set bgGradientDir = module.style.overlay_gradient_direction %}
      {% set bgGradientColor1 = module.style.overlay_gradient_color_1.color %}
      {% set bgGradientColor1Opacity = module.style.overlay_gradient_color_1.opacity|int %}
      {% set bgGradientColor1Opacity = bgGradientColor1Opacity / 100 %}
      {% set bgGradientColor2 = module.style.overlay_gradient_color_2.color %}
      {% set bgGradientColor2Opacity = module.style.overlay_gradient_color_2.opacity|int %}
      {% set bgGradientColor2Opacity = bgGradientColor2Opacity / 100 %}

      {% if module.style.overlay_gradient_opacity < 100 %}
        {% set generalOpacity = module.style.overlay_gradient_opacity / 100 %}
        {% set bgGradientColor1Opacity = 1 %}
        {% set bgGradientColor2Opacity = 1 %}
      {% endif %}
    {% endif %}

  {% endif %}

{% elif module.style.background == 'gradient' && module.style.background_gradient_direction %}
  {% set bgGradientDir = module.style.background_gradient_direction %}
  {% set bgGradientColor1 = module.style.background_gradient_color_1.color %}
  {% set bgGradientColor2 = module.style.background_gradient_color_2.color %}
{% endif %}

{% if bgGradientDir == 'hor' %}
  {% set bgGradientDirMozWeb = 'left' %}
  {% set bgGradientDirStd = 'to right' %}
  {% set bgGradientDirIEFb = 1 %}
{% elif bgGradientDir == 'vert' %}
  {% set bgGradientDirMozWeb = 'top' %}
  {% set bgGradientDirStd = 'to bottom' %}
  {% set bgGradientDirIEFb = 0 %}
{% elif bgGradientDir == 'diag_tl_br' %}
  {% set bgGradientDirMozWeb = '-45deg' %}
  {% set bgGradientDirStd = '135deg' %}
  {% set bgGradientDirIEFb = 1 %}
{% elif bgGradientDir == 'diag_bl_tr' %}
  {% set bgGradientDirMozWeb = '45deg' %}
  {% set bgGradientDirStd = '45deg' %}
  {% set bgGradientDirIEFb = 1 %}
{% endif %}

{% if module.anchor_link_id  %}<div class="pwr-anchor" id="{{ module.anchor_link_id }}"></div>{% endif %}
<div class="pwr-sec-split {% if module.layout.centered %}pwr--align-c{% endif %} {% if module.layout.section_variant  == 'img_left' %}pwr-sec-split--invert-cols{% endif %} {% if module.style.scheme == 'dark' %}pwr--dark{% else %}pwr--light{% endif %}"
    {# Animation on Scroll #}
    {{ get_aos(module.animation.section) }}       
>
  <div class="{% if !module.layout.full_width %}page-center{% endif %} pwr--relative">
    <div class="row-fluid pwr--clearfix">
      <div class="pwr-sec-split__left pwr--relative lazyload" 
           {% if bgColor %}style="background-color: rgba({{ bgColor }}, {{ bgOpacity }})"
          {% elif bgImg.src && bgImgPos != 'parallax' %}
            {# Lazy load and resposive images for background-image #}           
            data-bgset="{{ resize_image_url(bgImg.src,theme.performance.images.image_width_xs) }} {{ theme.performance.images.image_width_xs }}w, {{ resize_image_url(bgImg.src,theme.performance.images.image_width_xs * theme.performance.retina_images.image_retina_scaling_factor) }} {{ theme.performance.images.image_width_xs * 2 }}w [(max-width: 575px)] | 
                        {{ resize_image_url(bgImg.src,theme.performance.images.image_width_s) }} {{ theme.performance.images.image_width_s }}w, {{ resize_image_url(bgImg.src,theme.performance.images.image_width_s * theme.performance.retina_images.image_retina_scaling_factor) }} {{ theme.performance.images.image_width_s * 2 }}w [(max-width: 767px)] | 
                        {{ resize_image_url(bgImg.src,theme.performance.images.image_width_m) }} {{ theme.performance.images.image_width_m }}w, {{ resize_image_url(bgImg.src,theme.performance.images.image_width_m * theme.performance.retina_images.image_retina_scaling_factor) }} {{ theme.performance.images.image_width_m * 2 }}w [(max-width: 991px)] | 
                        {{ resize_image_url(bgImg.src,theme.performance.images.image_width_l) }} {{ theme.performance.images.image_width_l }}w, {{ resize_image_url(bgImg.src,theme.performance.images.image_width_l * theme.performance.retina_images.image_retina_scaling_factor) }} {{ theme.performance.images.image_width_l * 2 }}w [(max-width: 1199px)] |
                        {{ resize_image_url(bgImg.src,theme.performance.images.image_max_size * theme.performance.retina_images.image_retina_scaling_factor) }}"
            data-sizes="auto"
            style="background-size: cover;background-position: {{ bgImgPos }};"
           {% elif bgImg.src && bgImgPos == 'parallax' %}
            style="background-color: transparent;" 
           {% elif bgGradientDir %}
            style="
                  background: {{ bgGradientColor1 }};
                  background: -moz-linear-gradient({{ bgGradientDirMozWeb }}, {{ bgGradientColor1 }} 0%, {{ bgGradientColor2 }} 100%);
                  background: -webkit-linear-gradient({{ bgGradientDirMozWeb }}, {{ bgGradientColor1 }} 0%, {{ bgGradientColor2 }} 100%);
                  background: linear-gradient({{ bgGradientDirStd }}, {{ bgGradientColor1 }} 0%, {{ bgGradientColor2 }} 100%);
                  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='{{ bgGradientColor1 }}', endColorstr='{{ bgGradientColor2 }}',GradientType={{ bgGradientDirIEFb }} );
                  "     
           {% endif %}           
           >
          {% if bgImg.src && bgImgPos == 'parallax' %}
            <img data-src="{{ bgImg.src }}" class="pwr-parallax lazyload" alt="{{ bgImg.alt }}" width="{% if bgImg.width > 2000 %}2000{% else %}{{ bgImg.width }}{% endif %}">
          {% endif %}
          {% if bgVid %}
          <div class="pwr-video-background {{ bgVidPos }}">
            {% if isYtVid %}
            <div class="pwr-video-background__youtube {% if bgImgPos == 'parallax' %}pwr-parallax{% endif %}">
              <div class="player" data-property="{videoURL:'{{ module.style.youtube_link }}',containment:'self', autoPlay:true, mute:true, showControls: false, useOnMobile: true, playOnlyIfVisible: true}"></div>
            </div>
            {% else %}
            <video autoplay playsinline muted loop src="{{ bgVid }}" class="{% if bgImgPos == 'parallax' %} pwr-parallax{% endif %} lazyload"></video>
            {% endif %}
          </div>
          {% endif %}

          {% if (bgImg.src || bgVid) && module.style.background_image_overlay == 'color' %}
          <div class="pwr--abs-full" style="background-color: rgba({{ bgOverlayColor }}, {{ bgOverlayOpacity }})"></div>
          {% elif (bgImg.src || bgVid) && module.style.background_image_overlay == 'gradient' %}
          <div class="pwr--abs-full" style="
                    background: {{ bgGradientColor1 }};
                    background: -moz-linear-gradient({{ bgGradientDirMozWeb }}, {{ bgGradientColor1 }} 0%, {{ bgGradientColor2 }} 100%);
                    background: -webkit-linear-gradient({{ bgGradientDirMozWeb }}, rgba({{ bgGradientColor1|convert_rgb }}, {{ bgGradientColor1Opacity }}) 0%, rgba({{ bgGradientColor2|convert_rgb  }}, {{ bgGradientColor2Opacity }}) 100%);
                    background: linear-gradient({{ bgGradientDirStd }}, rgba({{ bgGradientColor1|convert_rgb  }}, {{ bgGradientColor1Opacity }}) 0%, rgba({{ bgGradientColor2|convert_rgb  }}, {{ bgGradientColor2Opacity }}) 100%);
                    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='{{ bgGradientColor1 }}', endColorstr='{{ bgGradientColor2 }}',GradientType={{ bgGradientDirIEFb }} );
                    opacity: {{ generalOpacity }};
                    "></div>
          {% endif %}
        
        <div class="pwr-sec-split__content pwr--relative" {% if module.layout.section_height %}style="height:{{ module.layout.section_height }}px"{% endif %}>
          {% if module.intro_to_title %}
          <span class="pwr-sec__title-intro pwr-sec-split__title-intro"
            {# Animation on Scroll #}
            {{ get_aos(module.animation.intro_to_title) }}       
          >
            {{ module.intro_to_title }}
          </span>
          {% endif %}
          {% if module.title_sel_heading && module.title %}
          <{{ module.title_sel_heading }} class="pwr-sec__title pwr-sec-split__title"
            {# Animation on Scroll #}
            {{ get_aos(module.animation.title) }}       
          >{{ module.title }}</{{ module.title_sel_heading }}>
          {% endif %}          
          <span class="pwr-rich-text pwr-sec__desc pwr-sec-split__desc"
            {# Animation on Scroll #}
            {{ get_aos(module.animation.description) }}       
          >
            {{ module.desc }}
          </span>
          {% if module.is_testimonial %}
          <div class="pwr-sec-split__testimonial-name pwr-testimonial"
            {# Animation on Scroll #}
            {{ get_aos(module.animation.testimonial) }}       
          >
            <span class="pwr-testimonial__name">{{ module.name_ }}</span>
            <span class="pwr-testimonial__job-title">{{ module.job_title }}</span>
          </div>
          {% endif %}
          {% if module.social_icons|length > 0 %}
          <div class="pwr-sec-split__contact"
            {# Animation on Scroll #}
            {{ get_aos(module.animation.social_icons) }}       
          >
            {% for social_icon in module.social_icons %}
              {% if social_icon.internal_url|length > 0 %}
                {% set isLink = true %}
                {% set isInternalLink = true %}
                {% set href = social_icon.internal_url %}
              {% else if social_icon.link.url.href %}
                {% set isLink = true %}
                {% set href = social_icon.link.url.href %}
                {% if social_icon.link.url.type == "EMAIL_ADDRESS" %}
                  {% set href = "mailto:" + href %}
                {% endif %}  
              {% else %}
                {% set isLink = false %}
              {% endif %}
              <{% if isLink %}a href="{{ href }}" {% if social_icon.link.open_in_new_tab && !isInternalLink %}target="_blank" rel="noopener"{% endif %} {% if social_icon.link.no_follow && !isInternalLink %}rel="nofollow"{% endif %} aria-label="Social Icon"{% else %}div{% endif %} class="pwr-social-icon">
                {% if social_icon.flip_icon_horizontally %}<div class="pwr--flip-hor">{% endif %}
                {% if social_icon.icon %}{% icon name="{{ social_icon.icon.name }}" style="{{ social_icon.icon.type }}" unicode="{{ social_icon.icon.unicode }}" %}{% endif %}
                {% if social_icon.flip_icon_horizontally %}</div>{% endif %}
              </{% if isLink %}a{% else %}div{% endif %}>
            {% endfor %}
          </div>
          {% endif %}      
          {% if module.logo.src %}
          <img class="pwr-sec-split__logo" src="{{ module.logo.src }}" alt="{{ module.logo.alt }}" width="{{ module.logo.width }}" height="{{ module.logo.height }}" 
            {# Animation on Scroll #}
            {{ get_aos(module.animation.content_image) }}       
          />
          {% endif %}
          {% if module.link_obj.url.href %}
          <a class="pwr-sec-split__link" href="{{ module.link_obj.url.href }}" {% if module.link_obj.open_in_new_tab %}target="_blank" rel="noopener"{% endif %} {% if module.link_obj.no_follow %}rel="nofollow"{% endif %}>{{ module.translation.txt_link }}<span class="pwr-link-icon pwr--padding-l-sm">{% icon name="arrow-right" style="SOLID" unicode="f061" %}</span></a>
          {% endif %}
          {% if module.btn_type == 'cta' && module.ctas|length > 0 %}
            <div class="pwr-cta-container pwr-sec-split__cta-container pwr--clearfix"
              {# Animation on Scroll #}
              {{ get_aos(module.animation.button) }}       
            >
              <div class="pwr--neg-margin-lr-10">
              {% for cta in module.ctas %}
                <div class="pwr-cta-container__cta pwr-sec-split__cta pwr-cta {{ module.style.cta_style }} {{ module.style.cta_size }}">
                  {% cta "name" guid="{{cta}}" %}
                </div>
              {% endfor %}
              </div>
            </div>
          {% elif module.btn_type == 'btn' && module.btns|length > 0 %}
            <div class="pwr-cta-container pwr-sec-split__cta-container pwr--clearfix"
              {# Animation on Scroll #}
              {{ get_aos(module.animation.button) }}       
            >
              <div class="pwr--neg-margin-lr-10">
              {% for btn in module.btns %}
                <div class="pwr-cta-container__cta pwr-sec-split__cta pwr-cta {{ module.style.cta_style }} {{ module.style.cta_size }}">
                  <a class="cta_button" {% if btn.link.url.href %}href="{% if btn.link.url.type == "EMAIL_ADDRESS" %}mailto:{% endif %}{{ btn.link.url.href }}"{% endif %} {% if btn.link.no_follow %}rel="nofollow"{% endif %} {% if btn.link.open_in_new_tab %}target="_blank"{% endif %} rel="noopener" title="Button {{ btn.title }}">{{ btn.title }}</a>                    
                </div>
              {% endfor %}
              </div>
            </div>
          {% endif %}
        </div>
      </div>
      <div class="pwr-sec-split__right"
        {# Animation on Scroll #}
        {{ get_aos(module.animation.image_video) }}       
      >
        <div  class="pwr-sec-split__img {% if module.img %}lazyload{% endif %}" 
              {% if module.img %}
              data-bgset="{{ resize_image_url(module.img.src,theme.performance.images.image_width_xs) }} {{ theme.performance.images.image_width_xs }}w, {{ resize_image_url(module.img.src,theme.performance.images.image_width_xs * 2) }} {{ theme.performance.images.image_width_xs * 2 }}w [(max-width: 575px)] | 
                          {{ resize_image_url(module.img.src,theme.performance.images.image_width_s) }} {{ theme.performance.images.image_width_s }}w, {{ resize_image_url(module.img.src,theme.performance.images.image_width_s * 2) }} {{ theme.performance.images.image_width_s * 2 }}w [(max-width: 767px)] | 
                          {{ resize_image_url(module.img.src,theme.performance.images.image_width_m / 2) }} {{ theme.performance.images.image_width_m }}w, {{ resize_image_url(module.img.src,theme.performance.images.image_width_m ) }} {{ theme.performance.images.image_width_m * 2 }}w [(max-width: 991px)] | 
                          {{ resize_image_url(module.img.src,theme.performance.images.image_width_l / 2) }} {{ theme.performance.images.image_width_l }}w, {{ resize_image_url(module.img.src,theme.performance.images.image_width_l ) }} {{ theme.performance.images.image_width_l * 2 }}w [(max-width: 1199px)] |
                          {{ resize_image_url(module.img.src,theme.performance.images.image_max_size * theme.performance.retina_images.image_retina_scaling_factor / 2) }} {{ theme.performance.images.image_width_l * 2 }}w"
              data-sizes="auto"
              {% endif %}
              style=" {% if module.layout.section_height %}height:{{ module.layout.section_height }}px{% endif %}
                      {% if module.img %}; background-position: {{ module.style.media_position }};{% if bgColor %}background-color: rgba({{ bgColor }}, {{ bgOpacity }});{% endif %} {% endif %}">{% if !module.img && ( !module.video || module.video == 'null' ) && module.youtube_link|length == 0 %}Please select an image{% endif %}</div> 
        {% if ( module.video && module.video != 'null') || module.youtube_link|length > 0 %}
        <div class="pwr-sec-split__video pwr-video-background pwr-video-background--pos-{{ module.style.media_position }}" {% if module.layout.section_height %}style="height:{{ module.layout.section_height }}px"{% endif %}>
          {% if module.video && module.video != 'null' %}
          <video autoplay playsinline muted loop src="{{ module.video }}"></video>
          {% else if module.youtube_link|length > 0 %}
          <div class="pwr-video-background__youtube">
            <div class="player" data-property="{videoURL:'{{ module.youtube_link }}', containment:'self', autoPlay:true, mute:true, showControls: false, useOnMobile: true, playOnlyIfVisible: true}"></div>
          </div>
          {% endif %}
        </div>
        {% endif %}        
      </div>      
    </div>
  </div>
</div>
